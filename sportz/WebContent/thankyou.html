<!-- /*
* Bootstrap 5
* Template Name: Furni
* Template Author: Untree.co
* Template URI: https://untree.co/
* License: https://creativecommons.org/licenses/by/3.0/
*/ -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="author" content="Untree.co" />
    <link rel="shortcut icon" href="favicon.png" />

    <meta name="description" content="" />
    <meta name="keywords" content="bootstrap, bootstrap4" />

    <!-- Bootstrap CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <link href="css/tiny-slider.css" rel="stylesheet" />
    <link href="css/style.css" rel="stylesheet" />
    <title>Sportz thank you</title>
  </head>

  <body>
    <div class="untree_co-section">
      <div class="container">
        <div class="row">
          <div class="col-md-12 text-center pt-5">
            <span class="display-3 thankyou-icon text-primary">
              <svg
                width="1em"
                height="1em"
                viewBox="0 0 16 16"
                class="bi bi-cart-check mb-5"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  d="M11.354 5.646a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L8 8.293l2.646-2.647a.5.5 0 0 1 .708 0z"
                />
                <path
                  fill-rule="evenodd"
                  d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm7 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"
                />
              </svg>
            </span>
            <h2 class="display-3 text-black">Thank you!</h2>
            <p class="lead mb-5">You order was successfuly completed.</p>
            <p>
              <a href="shop.html" class="btn btn-sm btn-outline-black"
                >Back to shop</a
              >
            </p>
          </div>
        </div>
      </div>
    </div>

    <div  style="display: none;" id="hide">
      <style>
        body {
          margin: 0;
          font-family: Roboto, -apple-system, BlinkMacSystemFont, "Segoe UI",
            Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji",
            "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
          font-size: 0.8125rem;
          font-weight: 400;
          line-height: 1.5385;
          color: #333;
          text-align: left;
          background-color: #eee;
        }

        .mt-50 {
          margin-top: 50px;
        }

        .mb-50 {
          margin-bottom: 50px;
        }

        .card {
          position: relative;
          display: -ms-flexbox;
          display: flex;
          -ms-flex-direction: column;
          flex-direction: column;
          min-width: 0;
          word-wrap: break-word;
          background-color: #fff;
          background-clip: border-box;
          border: 1px solid rgba(0, 0, 0, 0.125);
          border-radius: 0.1875rem;
        }

        .card-img-actions {
          position: relative;
        }

        .card-body {
          -ms-flex: 1 1 auto;
          flex: 1 1 auto;
          padding: 1.25rem;
          text-align: center;
        }

        .card-title {
          margin-top: 10px;
          font-size: 17px;
        }

        .invoice-color {
          color: red !important;
        }

        .card-header {
          padding: 0.9375rem 1.25rem;
          margin-bottom: 0;
          background-color: rgba(0, 0, 0, 0.02);
          border-bottom: 1px solid rgba(0, 0, 0, 0.125);
        }

        a {
          text-decoration: none !important;
        }

        .btn-light {
          color: #333;
          background-color: #fafafa;
          border-color: #ddd;
        }

        .header-elements-inline {
          display: -ms-flexbox;
          display: flex;
          -ms-flex-align: center;
          align-items: center;
          -ms-flex-pack: justify;
          justify-content: space-between;
          -ms-flex-wrap: nowrap;
          flex-wrap: nowrap;
        }

        @media (min-width: 768px) {
          .wmin-md-400 {
            min-width: 400px !important;
          }
        }

        .btn-primary {
          color: #fff;
          background-color: #2196f3;
        }

        .btn-labeled > b {
          position: absolute;
          top: -1px;
          background-color: blue;
          display: block;
          line-height: 1;
          padding: 0.62503rem;
        }
      </style>

      <div class="container d-flex justify-content-center mt-50 mb-50">
        <div class="row">
          <div class="col-md-12">
            <!-- start -->
            <div class="card" id="invoice">
              <div class="card-header bg-transparent header-elements-inline">
                <h6 class="card-title text-primary">Sale invoice</h6>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-sm-6"></div>
                  <div class="col-sm-6">
                    <div class="mb-4">
                      <div class="text-sm-right">
                        <h4 class="invoice-color mb-2 mt-md-2" id="orderId">
                          Invoice
                        </h4>
                        <ul class="list list-unstyled mb-0">
                          <li>
                            Date:
                            <span
                              class="font-weight-semibold"
                              id="orderDate"
                            ></span>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="d-md-flex flex-md-wrap">
                  <div class="mb-4 mb-md-2 text-left">
                    <span class="text-muted">Invoice To:</span>
                    <ul class="list list-unstyled mb-0">
                      <li>
                        <h5 class="my-2" id="orderName"></h5>
                      </li>
                      <li>
                        <span
                          class="font-weight-semibold"
                          id="orderAddress"
                        ></span>
                      </li>
                      <li>
                        <span
                          class="font-weight-semibold"
                          id="orderPhoneNumber"
                        ></span>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="table-responsive">
                <table class="table table-lg">
                  <thead>
                    <tr>
                      <th>Description</th>
                      <th>Price</th>
                      <th>Quantity</th>
                      <th>Total</th>
                    </tr>
                  </thead>
                  <tbody id="tableData"></tbody>
                </table>
              </div>
              <div class="card-body">
                <div class="d-md-flex flex-md-wrap">
                  <div class="pt-2 mb-3 wmin-md-400 ml-auto">
                    <!-- <h6 class="mb-3 text-left">Total due</h6> -->
                    <div class="table-responsive">
                      <table class="table">
                        <tbody>
                          <!-- <tr>
														<th class="text-left">Subtotal:</th>
														<td class="text-right">$1,090</td>
													</tr>
													<tr>
														<th class="text-left">Tax: <span class="font-weight-normal">(25%)</span>
														</th>
														<td class="text-right">$27</td>
													</tr> -->
                          <tr>
                            <th class="text-left">Total:</th>
                            <td class="text-right text-primary">
                              <h5
                                class="font-weight-semibold"
                                id="orderTotal"
                              ></h5>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>

              <!-- end -->
            </div>
            <div class="col-md-12 text-right mb-3">
              <button class="btn btn-primary" id="download">
                Download invoice
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/tiny-slider.js"></script>
    <script src="js/custom.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>

    <script>
      //document.getElementById("hide").style.display = "none"

      document.getElementById("download").addEventListener("click", () => {
        const invoice = this.document.getElementById("invoice");
        console.log(invoice);
        console.log(window);
        var opt = {
          margin: 1,
          filename: "order.pdf",
          image: { type: "jpeg", quality: 0.98 },
          html2canvas: { scale: 2 },
          jsPDF: { unit: "in", format: "letter", orientation: "portrait" },
        };
        //ml2pdf().from(invoice).set(opt).save();
        html2pdf(invoice);
      });

      const loadData = async (e) => {
        const {
          data: { products },
        } = await axios.post("http://localhost:8080/sportz/Thankyou");
        // post req to get data from db
        // let array = {
        // 	product_data,  // array containing all ordered product details
        // 	otder_id,
        // 	orderName,
        // 	orderPhoneNumber,
        // 	orderAddress
        // }
        // const product_data = [{
        // 	product_name: "hello",
        // 	product_price: 200,
        // 	quantity: 2,
        // 	total: 400
        // }, {
        // 	product_name: "ballon",
        // 	product_price: 20,
        // 	quantity: 25,
        // 	total: 500
        // }
        // ]   // data from post request
        product_data = JSON.parse(products[0].product);
        console.log();
        // console.log(products[1].orderId)

        // const product_data = JSON.parse(products[0].product);
        // console.log(products_data);
        let productHtmlTable = ""; // table populate
        let total = 0;
        const date = new Date().toLocaleDateString("de-DE");
        document.getElementById("orderId").innerText = products[0].orderId; //order table
        document.getElementById("orderDate").innerText = date; //order date
        document.getElementById("orderName").innerText =
          products[0].customerName; //customer table
        document.getElementById("orderPhoneNumber").innerText =
          products[0].orderPhoneNumber; // customer table
        document.getElementById("orderAddress").innerText =
          products[0].orderAddress;
        products &&
          product_data.map((item) => {
            let localTotal = item.product_price * item.quantity;
            total = total + localTotal;
            productHtmlTable += `
				 						<tr>
				 							<td><h6 class="mb-0">${item.product_name}</h6></td>
				 							<td>${item.product_price}</td>
				 							<td>${item.quantity}</td>
				 							<td><span class="font-weight-semibold">${localTotal}</span></td>
				 						</tr>
				 			`;
          });
        document.getElementById("tableData").innerHTML = productHtmlTable;
        document.getElementById("orderTotal").innerText = "â‚¹" + total;
        setTimeout(() => {
          document.getElementById("download").click();
        }, 1000);
      };
      loadData();
    </script>
  </body>
</html>
